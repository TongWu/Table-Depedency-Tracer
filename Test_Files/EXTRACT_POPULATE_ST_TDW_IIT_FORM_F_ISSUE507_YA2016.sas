/**************************************************************************** 
 * Job:             EXTRACT_SOURCE_ST_TDW_IIT_FORM_F      A5TM814S.BN000MBU * 
 * Description:     Version 1.0                                             * 
 *                                                                          * 
 * Metadata Server: NESAS01R.IRASOR.GOV.SG                                  * 
 * Port:            8565                                                    * 
 * Location:        /ADMS_UDP/ExtractSource                                 * 
 *                                                                          * 
 * Server:          SASDI                                 A5TM814S.AT000002 * 
 *                                                                          * 
 * Source Table:    TDW_IIT_FORM_F -                      A5TM814S.BH000MH4 * 
 *                   udp_hist.HIST_TDW_IIT_FORM_F                                  * 
 * Target Table:    DWER_HIST_TDW_IIT_FORM_F -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                            * 
 *                                                                          * 
 * Generated on:    Monday, 3 August, 2020 8:56:46 AM SGT                   * 
 * Generated by:                                                * 
 * Version:         SAS Data Integration Studio 4.904                       * 
 ****************************************************************************/ 

/* Generate the process id for job  */ 
%put Process ID: &SYSJOBID;

/* General macro variables  */ 
%let jobID = %quote(A5TM814S.BN000MBU);
%let etls_jobName = %nrquote(EXTRACT_SOURCE_ST_TDW_IIT_FORM_F);
%let etls_userID = %nrquote();

/* Setup to capture return codes  */ 
%global job_rc trans_rc sqlrc;
%let sysrc = 0;
%let job_rc = 0;
%let trans_rc = 0;
%let sqlrc = 0;
%let syscc = 0;
%global etls_stepStartTime; 
/* initialize syserr to 0 */ 
data _null_; run;

/* Print udp_partition_dt_filter */
/* %let UDP_PART_FILTER = "%sysfunc(putn('31DEC2016'd, yymmdd10.))"; */
/* %put NOTE: Filter partition date is &UDP_PART_FILTER; */

%macro rcSet(error); 
   %if (&error gt &trans_rc) %then 
      %let trans_rc = &error;
   %if (&error gt &job_rc) %then 
      %let job_rc = &error;
%mend rcSet; 

%macro rcSetDS(error); 
   if &error gt input(symget('trans_rc'),12.) then 
      call symput('trans_rc',trim(left(put(&error,12.))));
   if &error gt input(symget('job_rc'),12.) then 
      call symput('job_rc',trim(left(put(&error,12.))));
%mend rcSetDS; 

/* Create metadata macro variables */
%let IOMServer      = %nrquote(SASDI);
%let metaPort       = %nrquote(8565);
%let metaServer     = %nrquote(NESAS01R.IRASOR.GOV.SG);

/* Setup for capturing job status  */ 
%let etls_startTime = %sysfunc(datetime(),datetime.);
%let etls_recordsBefore = 0;
%let etls_recordsAfter = 0;
%let etls_lib = 0;
%let etls_table = 0;

%global etls_debug; 
%macro etls_setDebug; 
   %if %str(&etls_debug) ne 0 %then 
      OPTIONS MPRINT%str(;); 
%mend; 
%etls_setDebug; 

/*---- Start of Pre-Process Code  ----*/ 

%udp_stg_filter;
/*---- End of Pre-Process Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 

/*==========================================================================* 
 * Step:            Extract                               A5TM814S.BP001307 * 
 * Transform:       Extract                                                 * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    TDW_IIT_FORM_F -                      A5TM814S.BH000MH4 * 
 *                   udp_hist.HIST_TDW_IIT_FORM_F                                  * 
 * Target Table:    DWER_HIST_TDW_IIT_FORM_F -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                            * 
 *==========================================================================*/ 

%let transformID = %quote(A5TM814S.BP001307);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let etls_recnt = 0;
%macro etls_recordCheck; 
   %let etls_recCheckExist = %eval(%sysfunc(exist(udp_hist.HIST_TDW_IIT_FORM_F , DATA)) or 
         %sysfunc(exist(udp_hist.HIST_TDW_IIT_FORM_F , VIEW))); 
   
   %if (&etls_recCheckExist) %then
   %do;
      proc sql noprint;
         select count(*) into :etls_recnt from udp_hist.HIST_TDW_IIT_FORM_F
         (dbcondition="where UDP_PARTITION_DT = '2016-12-31'");
      quit;
   %end;
%mend etls_recordCheck;
%etls_recordCheck;

%let SYSLAST = %nrquote(udp_hist.HIST_TDW_IIT_FORM_F); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

%put %str(NOTE: Filter by partition ...);
proc sql;
   create table UDPADMS.DWER_HIST_TDW_IIT_FORM_F_INT as
      select * from &SYSLAST 
      (dbcondition="where UDP_PARTITION_DT = '2016-12-31'");
quit;

/*---- Map the columns  ----*/ 
proc datasets lib = UDPADMS nolist nowarn memtype = (data view);
   delete DWER_HIST_TDW_IIT_FORM_F;
quit;

%put %str(NOTE: Mapping columns ...);
proc sql;
   create table UDPADMS.DWER_HIST_TDW_IIT_FORM_F as
      select
         AdjPL_1   
            format = 19.2
            informat = 19.2
            label = 'AdjPL_1',
         AdjPL_2   
            format = 19.2
            informat = 19.2
            label = 'AdjPL_2',
         AdjPL_3   
            format = 19.2
            informat = 19.2
            label = 'AdjPL_3',
         AdjPL_4   
            format = 19.2
            informat = 19.2
            label = 'AdjPL_4',
         AdjPL_5   
            format = 19.2
            informat = 19.2
            label = 'AdjPL_5',
         AdjPLInd_1   
            label = 'AdjPLInd_1',
         AdjPLInd_2   
            label = 'AdjPLInd_2',
         AdjPLInd_3   
            label = 'AdjPLInd_3',
         AdjPLInd_4   
            label = 'AdjPLInd_4',
         AdjPLInd_5   
            label = 'AdjPLInd_5',
         AdjTEmptIL   
            format = 19.2
            informat = 19.2
            label = 'AdjTEmptIL',
         AdjTotEmptIncome   
            format = 19.2
            informat = 19.2
            label = 'AdjTotEmptIncome',
         AllowDeduct_1   
            format = 19.2
            informat = 19.2
            label = 'AllowDeduct_1',
         AllowDeduct_2   
            format = 19.2
            informat = 19.2
            label = 'AllowDeduct_2',
         AllowDeduct_3   
            format = 19.2
            informat = 19.2
            label = 'AllowDeduct_3',
         AllowDeduct_4   
            format = 19.2
            informat = 19.2
            label = 'AllowDeduct_4',
         AllowDeduct_5   
            format = 19.2
            informat = 19.2
            label = 'AllowDeduct_5',
         AM_NTA_DIFF   
            format = 19.2
            informat = 19.2
            label = 'AM_NTA_DIFF',
         AM_NTA_ORIGINAL   
            format = 19.2
            informat = 19.2
            label = 'AM_NTA_ORIGINAL',
         AmtGnDef   
            format = 19.2
            informat = 19.2
            label = 'AmtGnDef',
         AssessIncome   
            format = 19.2
            informat = 19.2
            label = 'AssessIncome',
         BKTOTInd   
            label = 'BKTOTInd',
         Bonus_1   
            format = 19.2
            informat = 19.2
            label = 'Bonus_1',
         Bonus_2   
            format = 19.2
            informat = 19.2
            label = 'Bonus_2',
         Bonus_3   
            format = 19.2
            informat = 19.2
            label = 'Bonus_3',
         BpassTOTRemECR   
            label = 'BpassTOTRemECR',
         BpassTxComp   
            label = 'BpassTxComp',
         CABF   
            format = 19.2
            informat = 19.2
            label = 'CABF',
         CABF_1   
            format = 19.2
            informat = 19.2
            label = 'CABF_1',
         CABF_2   
            format = 19.2
            informat = 19.2
            label = 'CABF_2',
         CABFOvr   
            label = 'CABFOvr',
         CD_ASMT_MODE   
            label = 'CD_ASMT_MODE',
         CD_ASMT_STATUS   
            label = 'CD_ASMT_STATUS',
         CD_FORM   
            label = 'CD_FORM',
         CD_TAX   
            label = 'CD_TAX',
         CD_TRANSACTION   
            label = 'CD_TRANSACTION',
         CD_UPDATE_REASON   
            label = 'CD_UPDATE_REASON',
         CD_UPDATE_SOURCE   
            label = 'CD_UPDATE_SOURCE',
         CI   
            format = 19.2
            informat = 19.2
            label = 'CI',
         Clearance   
            label = 'Clearance',
         CourseFeeRlf   
            format = 19.2
            informat = 19.2
            label = 'CourseFeeRlf',
         CPFCashRlf   
            format = 19.2
            informat = 19.2
            label = 'CPFCashRlf',
         CPFDC   
            format = 19.2
            informat = 19.2
            label = 'CPFDC',
         CPFTimeApportmtSGEmptIncome   
            format = 19.2
            informat = 19.2
            label = 'CPFTimeApportmtSGEmptIncome',
         CRAmount_1   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_1',
         CRAmount_2   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_2',
         CRAmount_3   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_3',
         CRAmount_4   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_4',
         CRAmount_5   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_5',
         CRAmount_6   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_6',
         CRAmount_7   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_7',
         CRAmount_8   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_8',
         CRAmount_9   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_9',
         CRAmount_10   
            format = 19.2
            informat = 19.2
            label = 'CRAmount_10',
         CROthersAmt   
            format = 19.2
            informat = 19.2
            label = 'CROthersAmt',
         CRECRAmt_1   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_1',
         CRECRAmt_2   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_2',
         CRECRAmt_3   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_3',
         CRECRAmt_4   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_4',
         CRECRAmt_5   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_5',
         CRECRAmt_6   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_6',
         CRECRAmt_7   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_7',
         CRECRAmt_8   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_8',
         CRECRAmt_9   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_9',
         CRECRAmt_10   
            format = 19.2
            informat = 19.2
            label = 'CRECRAmt_10',
         CRIdNo_1   
            label = 'CRIdNo_1',
         CRIdNo_2   
            label = 'CRIdNo_2',
         CRIdNo_3   
            label = 'CRIdNo_3',
         CRIdNo_4   
            label = 'CRIdNo_4',
         CRIdNo_5   
            label = 'CRIdNo_5',
         CRIdNo_6   
            label = 'CRIdNo_6',
         CRIdNo_7   
            label = 'CRIdNo_7',
         CRIdNo_8   
            label = 'CRIdNo_8',
         CRIdNo_9   
            label = 'CRIdNo_9',
         CRIdNo_10   
            label = 'CRIdNo_10',
         CRIdTyp_1   
            label = 'CRIdTyp_1',
         CRIdTyp_2   
            label = 'CRIdTyp_2',
         CRIdTyp_3   
            label = 'CRIdTyp_3',
         CRIdTyp_4   
            label = 'CRIdTyp_4',
         CRIdTyp_5   
            label = 'CRIdTyp_5',
         CRIdTyp_6   
            label = 'CRIdTyp_6',
         CRIdTyp_7   
            label = 'CRIdTyp_7',
         CRIdTyp_8   
            label = 'CRIdTyp_8',
         CRIdTyp_9   
            label = 'CRIdTyp_9',
         CRIdTyp_10   
            label = 'CRIdTyp_10',
         CROrder_1   
            label = 'CROrder_1',
         CROrder_2   
            label = 'CROrder_2',
         CROrder_3   
            label = 'CROrder_3',
         CROrder_4   
            label = 'CROrder_4',
         CROrder_5   
            label = 'CROrder_5',
         CROrder_6   
            label = 'CROrder_6',
         CROrder_7   
            label = 'CROrder_7',
         CROrder_8   
            label = 'CROrder_8',
         CROrder_9   
            label = 'CROrder_9',
         CROrder_10   
            label = 'CROrder_10',
         CRTyp_1   
            label = 'CRTyp_1',
         CRTyp_2   
            label = 'CRTyp_2',
         CRTyp_3   
            label = 'CRTyp_3',
         CRTyp_4   
            label = 'CRTyp_4',
         CRTyp_5   
            label = 'CRTyp_5',
         CRTyp_6   
            label = 'CRTyp_6',
         CRTyp_7   
            label = 'CRTyp_7',
         CRTyp_8   
            label = 'CRTyp_8',
         CRTyp_9   
            label = 'CRTyp_9',
         CRTyp_10   
            label = 'CRTyp_10',
         CRWMCRAmt_1   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_1',
         CRWMCRAmt_2   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_2',
         CRWMCRAmt_3   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_3',
         CRWMCRAmt_4   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_4',
         CRWMCRAmt_5   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_5',
         CRWMCRAmt_6   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_6',
         CRWMCRAmt_7   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_7',
         CRWMCRAmt_8   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_8',
         CRWMCRAmt_9   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_9',
         CRWMCRAmt_10   
            format = 19.2
            informat = 19.2
            label = 'CRWMCRAmt_10',
         CROthersWMCRAmt   
            format = 19.2
            informat = 19.2
            label = 'CROthersWMCRAmt',
         CRWMCRInd_1   
            label = 'CRWMCRInd_1',
         CRWMCRInd_2   
            label = 'CRWMCRInd_2',
         CRWMCRInd_3   
            label = 'CRWMCRInd_3',
         CRWMCRInd_4   
            label = 'CRWMCRInd_4',
         CRWMCRInd_5   
            label = 'CRWMCRInd_5',
         CRWMCRInd_6   
            label = 'CRWMCRInd_6',
         CRWMCRInd_7   
            label = 'CRWMCRInd_7',
         CRWMCRInd_8   
            label = 'CRWMCRInd_8',
         CRWMCRInd_9   
            label = 'CRWMCRInd_9',
         CRWMCRInd_10   
            label = 'CRWMCRInd_10',
         DelHospExp   
            format = 19.2
            informat = 19.2
            label = 'DelHospExp',
         DelHospExpDC   
            format = 19.2
            informat = 19.2
            label = 'DelHospExpDC',
         DetermineLevel   
            format = 19.2
            informat = 19.2
            label = 'DetermineLevel',
         DirFees_1   
            format = 19.2
            informat = 19.2
            label = 'DirFees_1',
         DirFees_2   
            format = 19.2
            informat = 19.2
            label = 'DirFees_2',
         DirFees_3   
            format = 19.2
            informat = 19.2
            label = 'DirFees_3',
         DisableSuspInd   
            label = 'DisableSuspInd',
         DonatBF   
            format = 19.2
            informat = 19.2
            label = 'DonatBF',
         DonatCFInd   
            label = 'DonatCFInd',
         DonatClaim   
            format = 19.2
            informat = 19.2
            label = 'DonatClaim',
         Donation_1   
            format = 19.2
            informat = 19.2
            label = 'Donation_1',
         Donation_2   
            format = 19.2
            informat = 19.2
            label = 'Donation_2',
         DonatPns   
            format = 19.2
            informat = 19.2
            label = 'DonatPns',
         DonatUtil   
            format = 19.2
            informat = 19.2
            label = 'DonatUtil',
         DT_CREATED   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_CREATED',
         DT_EFFECTIVE   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_EFFECTIVE',
         DT_LAST_EXTRACT   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_LAST_EXTRACT',
         DT_PROCESS   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_PROCESS',
         DT_TAX_PD_BEGIN   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_TAX_PD_BEGIN',
         DT_TAX_PD_END   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'DT_TAX_PD_END',
         EarnedIncomeRlf   
            format = 19.2
            informat = 19.2
            label = 'EarnedIncomeRlf',
         ECI   
            format = 19.2
            informat = 19.2
            label = 'ECI',
         ECINRNonEmptRt   
            format = 19.2
            informat = 19.2
            label = 'ECINRNonEmptRt',
         ECRErrCode   
            label = 'ECRErrCode',
         ECRErrCodeOvr   
            label = 'ECRErrCodeOvr',
         ECRInd   
            label = 'ECRInd',
         EEBRInd   
            label = 'EEBRInd',
         EFilingErr   
            label = 'EFilingErr',
         EmplCPFAII   
            format = 19.2
            informat = 19.2
            label = 'EmplCPFAII',
         EmplIncomeNetIncome_1   
            format = 19.2
            informat = 19.2
            label = 'EmplIncomeNetIncome_1',
         EmplIncomeNetIncome_2   
            format = 19.2
            informat = 19.2
            label = 'EmplIncomeNetIncome_2',
         EmplIncomeNetIncome_3   
            format = 19.2
            informat = 19.2
            label = 'EmplIncomeNetIncome_3',
         EmplIncomeTxRef_1   
            label = 'EmplIncomeTxRef_1',
         EmplIncomeTxRef_2   
            label = 'EmplIncomeTxRef_2',
         EmplIncomeTxRef_3   
            label = 'EmplIncomeTxRef_3',
         EmptCode_1   
            label = 'EmptCode_1',
         EmptCode_2   
            label = 'EmptCode_2',
         EmptCode_3   
            label = 'EmptCode_3',
         EmptIncomeAdjInd   
            label = 'EmptIncomeAdjInd',
         EmptIncomeOvr   
            label = 'EmptIncomeOvr',
         EmptyStatus   
            label = 'EmptyStatus',
         Exp_1   
            format = 19.2
            informat = 19.2
            label = 'Exp_1',
         Exp_2   
            format = 19.2
            informat = 19.2
            label = 'Exp_2',
         Exp_3   
            format = 19.2
            informat = 19.2
            label = 'Exp_3',
         FIOvr   
            label = 'FIOvr',
         FMForeignTxPaid   
            format = 19.2
            informat = 19.2
            label = 'FMForeignTxPaid',
         FMIntIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FMIntIncomeAmt',
         FMLAmt   
            format = 19.2
            informat = 19.2
            label = 'FMLAmt',
         FMLRlfDC   
            format = 19.2
            informat = 19.2
            label = 'FMLRlfDC',
         FMOtherIncome   
            format = 19.2
            informat = 19.2
            label = 'FMOtherIncome',
         FMPnsIncome   
            format = 19.2
            informat = 19.2
            label = 'FMPnsIncome',
         FMPtyIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FMPtyIncomeAmt',
         FMRoyaltyIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FMRoyaltyIncomeAmt',
         FMSubTot   
            format = 19.2
            informat = 19.2
            label = 'FMSubTot',
         FMTradeIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FMTradeIncomeAmt',
         FMTrustIncome   
            format = 19.2
            informat = 19.2
            label = 'FMTrustIncome',
         ForeignOtherIncome_1   
            format = 19.2
            informat = 19.2
            label = 'ForeignOtherIncome_1',
         ForeignOtherIncome_2   
            format = 19.2
            informat = 19.2
            label = 'ForeignOtherIncome_2',
         FRDivIncomePns   
            format = 19.2
            informat = 19.2
            label = 'FRDivIncomePns',
         FRDivIncomeTrust   
            format = 19.2
            informat = 19.2
            label = 'FRDivIncomeTrust',
         FRFIPns   
            format = 19.2
            informat = 19.2
            label = 'FRFIPns',
         FRFITrust   
            format = 19.2
            informat = 19.2
            label = 'FRFITrust',
         FRIntIncome   
            format = 19.2
            informat = 19.2
            label = 'FRIntIncome',
         FROtherFI   
            format = 19.2
            informat = 19.2
            label = 'FROtherFI',
         FRPtyIncome   
            format = 19.2
            informat = 19.2
            label = 'FRPtyIncome',
         FRRoyaltyIncome   
            format = 19.2
            informat = 19.2
            label = 'FRRoyaltyIncome',
         FRSubTot   
            format = 19.2
            informat = 19.2
            label = 'FRSubTot',
         FRTradeIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FRTradeIncomeAmt',
         FSDivIncomeRate   
            format = 7.2
            informat = 7.2
            label = 'FSDivIncomeRate',
         FSGrossDivAmt   
            format = 19.2
            informat = 19.2
            label = 'FSGrossDivAmt',
         FSIntIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FSIntIncomeAmt',
         FSIntIncomeRate   
            format = 7.2
            informat = 7.2
            label = 'FSIntIncomeRate',
         FSOtherIncomeRate   
            format = 7.2
            informat = 7.2
            label = 'FSOtherIncomeRate',
         FSRoyaltyIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'FSRoyaltyIncomeAmt',
         FSRoyaltyIncomeRate   
            format = 7.2
            informat = 7.2
            label = 'FSRoyaltyIncomeRate',
         FSSubTot   
            format = 19.2
            informat = 19.2
            label = 'FSSubTot',
         FstNAmt   
            format = 19.2
            informat = 19.2
            label = 'FstNAmt',
         FSTradeIncomeRate   
            format = 7.2
            informat = 7.2
            label = 'FSTradeIncomeRate',
         GCRAmt   
            format = 19.2
            informat = 19.2
            label = 'GCRAmt',
         Gender   
            label = 'Gender',
         GrossPL_1   
            format = 19.2
            informat = 19.2
            label = 'GrossPL_1',
         GrossPL_2   
            format = 19.2
            informat = 19.2
            label = 'GrossPL_2',
         GrossPL_3   
            format = 19.2
            informat = 19.2
            label = 'GrossPL_3',
         GrossPL_4   
            format = 19.2
            informat = 19.2
            label = 'GrossPL_4',
         GrossPL_5   
            format = 19.2
            informat = 19.2
            label = 'GrossPL_5',
         GrossTxPy   
            format = 19.2
            informat = 19.2
            label = 'GrossTxPy',
         GrossTxPyBefRebate   
            format = 19.2
            informat = 19.2
            label = 'GrossTxPyBefRebate',
         GrossTxPyBefSTRFTR   
            format = 19.2
            informat = 19.2
            label = 'GrossTxPyBefSTRFTR',
         HSRAmount_1   
            format = 19.2
            informat = 19.2
            label = 'HSRAmount_1',
         HSRAmount_2   
            format = 19.2
            informat = 19.2
            label = 'HSRAmount_2',
         HSRAmount_3   
            format = 19.2
            informat = 19.2
            label = 'HSRAmount_3',
         HSRAmount_4   
            format = 19.2
            informat = 19.2
            label = 'HSRAmount_4',
         HSRAmount_5   
            format = 19.2
            informat = 19.2
            label = 'HSRAmount_5',
         HSRIdNo_1   
            label = 'HSRIdNo_1',
         HSRIdNo_2   
            label = 'HSRIdNo_2',
         HSRIdNo_3   
            label = 'HSRIdNo_3',
         HSRIdNo_4   
            label = 'HSRIdNo_4',
         HSRIdNo_5   
            label = 'HSRIdNo_5',
         HSRIdTyp_1   
            label = 'HSRIdTyp_1',
         HSRIdTyp_2   
            label = 'HSRIdTyp_2',
         HSRIdTyp_3   
            label = 'HSRIdTyp_3',
         HSRIdTyp_4   
            label = 'HSRIdTyp_4',
         HSRIdTyp_5   
            label = 'HSRIdTyp_5',
         ID_FORMS_SEQ   
            format = 14.
            informat = 14.
            label = 'ID_FORMS_SEQ',
         ID_INTERNAL   
            format = 14.
            informat = 14.
            label = 'ID_INTERNAL',
         ID_RTN_SEQ   
            format = 14.
            informat = 14.
            label = 'ID_RTN_SEQ',
         ID_TRANSACTION   
            format = 16.
            informat = 16.
            label = 'ID_TRANSACTION',
         ID_UPDATED_BY   
            label = 'ID_UPDATED_BY',
         IDOAdj   
            format = 19.2
            informat = 19.2
            label = 'IDOAdj',
         IN_COMPLETED   
            label = 'IN_COMPLETED',
         IN_GDRTN   
            label = 'IN_GDRTN',
         IN_LATEST_ASMT   
            label = 'IN_LATEST_ASMT',
         Income_1   
            format = 19.2
            informat = 19.2
            label = 'Income_1',
         Income_2   
            format = 19.2
            informat = 19.2
            label = 'Income_2',
         Interest_1   
            format = 19.2
            informat = 19.2
            label = 'Interest_1',
         Interest_2   
            format = 19.2
            informat = 19.2
            label = 'Interest_2',
         IntExp_1   
            format = 19.2
            informat = 19.2
            label = 'IntExp_1',
         IntExp_2   
            format = 19.2
            informat = 19.2
            label = 'IntExp_2',
         LARAII   
            format = 19.2
            informat = 19.2
            label = 'LARAII',
         LARDC   
            format = 19.2
            informat = 19.2
            label = 'LARDC',
         LossApportmtAdjTotEmptIncome   
            format = 19.2
            informat = 19.2
            label = 'LossApportmtAdjTotEmptIncome',
         LossBF   
            format = 19.2
            informat = 19.2
            label = 'LossBF',
         LossBF_1   
            format = 19.2
            informat = 19.2
            label = 'LossBF_1',
         LossBF_2   
            format = 19.2
            informat = 19.2
            label = 'LossBF_2',
         LossBFInd   
            label = 'LossBFInd',
         LossBFOvrAmt   
            format = 19.2
            informat = 19.2
            label = 'LossBFOvrAmt',
         MarginalTaxRate   
            format = 7.2
            informat = 7.2
            label = 'MarginalTaxRate',
         MarTxRate   
            format = 19.2
            informat = 19.2
            label = 'MarTxRate',
         MarTxRate1   
            format = 7.2
            informat = 7.2
            label = 'MarTxRate1',
         MarTxRate2   
            format = 7.2
            informat = 7.2
            label = 'MarTxRate2',
         Medisave   
            format = 19.2
            informat = 19.2
            label = 'Medisave',
         MPAllow   
            format = 19.2
            informat = 19.2
            label = 'MPAllow',
         MPAllowCPFAII   
            format = 19.2
            informat = 19.2
            label = 'MPAllowCPFAII',
         MysTxRate   
            format = 7.2
            informat = 7.2
            label = 'MysTxRate',
         NetTradeIL   
            format = 19.2
            informat = 19.2
            label = 'NetTradeIL',
         NetTxPyRpy   
            format = 19.2
            informat = 19.2
            label = 'NetTxPyRpy',
         NextNAmt   
            format = 19.2
            informat = 19.2
            label = 'NextNAmt',
         NORManualCalc   
            label = 'NORManualCalc',
         NotionalFstNAmt   
            format = 19.2
            informat = 19.2
            label = 'NotionalFstNAmt',
         NotionalMarTxFstNAmt   
            format = 19.2
            informat = 19.2
            label = 'NotionalMarTxFstNAmt',
         NotionalMarTxFstNAmt2   
            format = 19.2
            informat = 19.2
            label = 'NotionalMarTxFstNAmt2',
         NotionalTxFstNAmt   
            format = 19.2
            informat = 19.2
            label = 'NotionalTxFstNAmt',
         NotionalTxFstNAmt2   
            format = 19.2
            informat = 19.2
            label = 'NotionalTxFstNAmt2',
         NoYrsDef   
            label = 'NoYrsDef',
         NRAI   
            format = 19.2
            informat = 19.2
            label = 'NRAI',
         NRArtTxRate   
            format = 7.2
            informat = 7.2
            label = 'NRArtTxRate',
         NRAssessIncome   
            format = 19.2
            informat = 19.2
            label = 'NRAssessIncome',
         NRCI   
            format = 19.2
            informat = 19.2
            label = 'NRCI',
         NRDonatApportmt   
            format = 19.2
            informat = 19.2
            label = 'NRDonatApportmt',
         NRDonatApportmtOtherIncome   
            format = 19.2
            informat = 19.2
            label = 'NRDonatApportmtOtherIncome',
         NRDonatApportmtSRSWD   
            format = 19.2
            informat = 19.2
            label = 'NRDonatApportmtSRSWD',
         NREmptIncome   
            format = 19.2
            informat = 19.2
            label = 'NREmptIncome',
         NREmptTxRate   
            format = 7.2
            informat = 7.2
            label = 'NREmptTxRate',
         NRIncomeSRSWD   
            format = 19.2
            informat = 19.2
            label = 'NRIncomeSRSWD',
         NRNonEmptTxRate   
            format = 7.2
            informat = 7.2
            label = 'NRNonEmptTxRate',
         NROtherIncome   
            format = 19.2
            informat = 19.2
            label = 'NROtherIncome',
         NRS40BCDInd   
            label = 'NRS40BCDInd',
         NRSRSTxRate   
            format = 7.2
            informat = 7.2
            label = 'NRSRSTxRate',
         NRTotNetIncome   
            format = 19.2
            informat = 19.2
            label = 'NRTotNetIncome',
         NRTxPy   
            format = 19.2
            informat = 19.2
            label = 'NRTxPy',
         NRTxPyEmptSRSWD   
            format = 19.2
            informat = 19.2
            label = 'NRTxPyEmptSRSWD',
         NRTxPyOtherIncome   
            format = 19.2
            informat = 19.2
            label = 'NRTxPyOtherIncome',
         NRTxPyS40   
            format = 19.2
            informat = 19.2
            label = 'NRTxPyS40',
         NRTxPyS40BCD   
            format = 19.2
            informat = 19.2
            label = 'NRTxPyS40BCD',
         NSmanIncome   
            format = 19.2
            informat = 19.2
            label = 'NSmanIncome',
         NSmenRlf   
            format = 19.2
            informat = 19.2
            label = 'NSmenRlf',
         NTProfit   
            format = 19.2
            informat = 19.2
            label = 'NTProfit',
         OneOffTxRebate   
            format = 19.2
            informat = 19.2
            label = 'OneOffTxRebate',
         OtherCrAdj   
            format = 19.2
            informat = 19.2
            label = 'OtherCrAdj',
         OtherDiv_1   
            format = 19.2
            informat = 19.2
            label = 'OtherDiv_1',
         OtherDiv_2   
            format = 19.2
            informat = 19.2
            label = 'OtherDiv_2',
         OtherExp_1   
            format = 19.2
            informat = 19.2
            label = 'OtherExp_1',
         OtherExp_2   
            format = 19.2
            informat = 19.2
            label = 'OtherExp_2',
         OtherIncomeDC   
            format = 19.2
            informat = 19.2
            label = 'OtherIncomeDC',
         OtherIncomeOvr   
            label = 'OtherIncomeOvr',
         OtherRRNS   
            label = 'OtherRRNS',
         Others_1   
            format = 19.2
            informat = 19.2
            label = 'Others_1',
         Others_2   
            format = 19.2
            informat = 19.2
            label = 'Others_2',
         Others_3   
            format = 19.2
            informat = 19.2
            label = 'Others_3',
         Pension_1   
            format = 19.2
            informat = 19.2
            label = 'Pension_1',
         PhyFormTyp   
            label = 'PhyFormTyp',
         PnsNetIncome_1   
            format = 19.2
            informat = 19.2
            label = 'PnsNetIncome_1',
         PnsNetIncome_2   
            format = 19.2
            informat = 19.2
            label = 'PnsNetIncome_2',
         PnsRent   
            format = 19.2
            informat = 19.2
            label = 'PnsRent',
         PnsTxRef_1   
            label = 'PnsTxRef_1',
         PnsTxRef_2   
            label = 'PnsTxRef_2',
         PRAmount_1   
            format = 19.2
            informat = 19.2
            label = 'PRAmount_1',
         PRAmount_2   
            format = 19.2
            informat = 19.2
            label = 'PRAmount_2',
         PRIdNo_1   
            label = 'PRIdNo_1',
         PRIdNo_2   
            label = 'PRIdNo_2',
         PRIdTyp_1   
            label = 'PRIdTyp_1',
         PRIdTyp_2   
            label = 'PRIdTyp_2',
         PSleep   
            format = 19.2
            informat = 19.2
            label = 'PSleep',
         RCB_1   
            label = 'RCB_1',
         RCB_2   
            label = 'RCB_2',
         RCB_3   
            label = 'RCB_3',
         RCB_4   
            label = 'RCB_4',
         RCB_5   
            label = 'RCB_5',
         RemInd   
            label = 'RemInd',
         Rent_1   
            format = 19.2
            informat = 19.2
            label = 'Rent_1',
         Rent_2   
            format = 19.2
            informat = 19.2
            label = 'Rent_2',
         ResComI   
            label = 'ResComI',
         ResidentStatus   
            label = 'ResidentStatus',
         ResInd   
            label = 'ResInd',
         RlfOvr   
            label = 'RlfOvr',
         S40Rlf   
            format = 19.2
            informat = 19.2
            label = 'S40Rlf',
         S46ARlf   
            format = 19.2
            informat = 19.2
            label = 'S46ARlf',
         S46BRlf   
            format = 19.2
            informat = 19.2
            label = 'S46BRlf',
         Salary_1   
            format = 19.2
            informat = 19.2
            label = 'Salary_1',
         Salary_2   
            format = 19.2
            informat = 19.2
            label = 'Salary_2',
         Salary_3   
            format = 19.2
            informat = 19.2
            label = 'Salary_3',
         SelfEmplCPFAII   
            format = 19.2
            informat = 19.2
            label = 'SelfEmplCPFAII',
         SgCorpTxRate   
            format = 7.2
            informat = 7.2
            label = 'SgCorpTxRate',
         SgDiv_1   
            format = 19.2
            informat = 19.2
            label = 'SgDiv_1',
         SgDiv_2   
            format = 19.2
            informat = 19.2
            label = 'SgDiv_2',
         SgDivTxRate   
            format = 7.2
            informat = 7.2
            label = 'SgDivTxRate',
         SgOtherIncome_1   
            format = 19.2
            informat = 19.2
            label = 'SgOtherIncome_1',
         SgOtherIncome_2   
            format = 19.2
            informat = 19.2
            label = 'SgOtherIncome_2',
         SgTxCredits   
            format = 19.2
            informat = 19.2
            label = 'SgTxCredits',
         SpecialAttn   
            label = 'SpecialAttn',
         SpecialisedAssmt   
            label = 'SpecialisedAssmt',
         SQ_ASSESSMENT   
            label = 'SQ_ASSESSMENT',
         SRSContr   
            format = 19.2
            informat = 19.2
            label = 'SRSContr',
         SRSTxWithheld   
            format = 19.2
            informat = 19.2
            label = 'SRSTxWithheld',
         StatusCode_1   
            label = 'StatusCode_1',
         StatusCode_2   
            label = 'StatusCode_2',
         STRFTRAmt   
            format = 19.2
            informat = 19.2
            label = 'STRFTRAmt',
         TArtExpertAmt   
            format = 19.2
            informat = 19.2
            label = 'TArtExpertAmt',
         TArtExpertInd   
            label = 'TArtExpertInd',
         TDivIntOtherIncomeAmt   
            format = 19.2
            informat = 19.2
            label = 'TDivIntOtherIncomeAmt',
         TDivIntOtherIncomeInd   
            label = 'TDivIntOtherIncomeInd',
         TDS   
            format = 19.2
            informat = 19.2
            label = 'TDS',
         TDSSgDiv_1   
            format = 19.2
            informat = 19.2
            label = 'TDSSgDiv_1',
         TDSSgDiv_2   
            format = 19.2
            informat = 19.2
            label = 'TDSSgDiv_2',
         TDTRUTCTxRemInd   
            label = 'TDTRUTCTxRemInd',
         TEmpt456Amt   
            format = 19.2
            informat = 19.2
            label = 'TEmpt456Amt',
         TEmpt456Ind   
            label = 'TEmpt456Ind',
         ThirdCMLPy   
            format = 19.2
            informat = 19.2
            label = 'ThirdCMLPy',
         TimeApportmt   
            format = 19.2
            informat = 19.2
            label = 'TimeApportmt',
         TLoss   
            format = 19.2
            informat = 19.2
            label = 'TLoss',
         TNORInd   
            label = 'TNORInd',
         TotAdjPL   
            format = 19.2
            informat = 19.2
            label = 'TotAdjPL',
         TotAllowCF   
            format = 19.2
            informat = 19.2
            label = 'TotAllowCF',
         TotCPFClaimMatch   
            format = 19.2
            informat = 19.2
            label = 'TotCPFClaimMatch',
         TotCPFLARAllow   
            format = 19.2
            informat = 19.2
            label = 'TotCPFLARAllow',
         TotCR   
            format = 19.2
            informat = 19.2
            label = 'TotCR',
         TotDonatBFClaimMatch   
            format = 19.2
            informat = 19.2
            label = 'TotDonatBFClaimMatch',
         TotEarnedIncome   
            format = 19.2
            informat = 19.2
            label = 'TotEarnedIncome',
         TotECI   
            format = 19.2
            informat = 19.2
            label = 'TotECI',
         TotExpIntLossCABF_1   
            format = 19.2
            informat = 19.2
            label = 'TotExpIntLossCABF_1',
         TotExpIntLossCABF_2   
            format = 19.2
            informat = 19.2
            label = 'TotExpIntLossCABF_2',
         TotFI   
            format = 19.2
            informat = 19.2
            label = 'TotFI',
         TotHSR   
            format = 19.2
            informat = 19.2
            label = 'TotHSR',
         TotIncomeAftRgr   
            format = 19.2
            informat = 19.2
            label = 'TotIncomeAftRgr',
         TotIncomeBefRgr   
            format = 19.2
            informat = 19.2
            label = 'TotIncomeBefRgr',
         TotIncomeLessExp   
            format = 19.2
            informat = 19.2
            label = 'TotIncomeLessExp',
         TotNAV   
            format = 19.2
            informat = 19.2
            label = 'TotNAV',
         TotPnsIncome   
            format = 19.2
            informat = 19.2
            label = 'TotPnsIncome',
         TotPR   
            format = 19.2
            informat = 19.2
            label = 'TotPR',
         TotPSHPECI   
            format = 19.2
            informat = 19.2
            label = 'TotPSHPECI',
         TotPSHPECIOr   
            label = 'TotPSHPECIOr',
         TotPtyIncome   
            format = 19.2
            informat = 19.2
            label = 'TotPtyIncome',
         TotRent   
            format = 19.2
            informat = 19.2
            label = 'TotRent',
         TotRlf   
            format = 19.2
            informat = 19.2
            label = 'TotRlf',
         TotShare_1   
            format = 19.2
            informat = 19.2
            label = 'TotShare_1',
         TotShare_2   
            format = 19.2
            informat = 19.2
            label = 'TotShare_2',
         TotTDS   
            format = 19.2
            informat = 19.2
            label = 'TotTDS',
         TotTxCr   
            format = 19.2
            informat = 19.2
            label = 'TotTxCr',
         TotTxRem   
            format = 19.2
            informat = 19.2
            label = 'TotTxRem',
         TPns3to10Amt   
            format = 19.2
            informat = 19.2
            label = 'TPns3to10Amt',
         TPns3to10Ind   
            label = 'TPns3to10Ind',
         TProfit   
            format = 19.2
            informat = 19.2
            label = 'TProfit',
         TProfitL   
            format = 19.2
            informat = 19.2
            label = 'TProfitL',
         TPSOAAttached   
            label = 'TPSOAAttached',
         TPtyInd   
            label = 'TPtyInd',
         (case when length(compress(put(tradecode_1,32.))) > 5 then 0 else tradecode_1  end) as TradeCode_1 length = 8
            format = 14.
            informat = 14.
            label = 'TradeCode_1',
         (case when length(compress(put(tradecode_2,32.))) > 5 then 0 else tradecode_2  end) as TradeCode_2 length = 8
            format = 14.
            informat = 14.
            label = 'TradeCode_2',
         (case when length(compress(put(tradecode_3,32.))) > 5 then 0 else tradecode_3  end) as TradeCode_3 length = 8
            format = 14.
            informat = 14.
            label = 'TradeCode_3',
         (case when length(compress(put(tradecode_4,32.))) > 5 then 0 else tradecode_4  end) as TradeCode_4 length = 8
            format = 14.
            informat = 14.
            label = 'TradeCode_4',
         (case when length(compress(put(tradecode_5,32.))) > 5 then 0 else tradecode_5  end) as TradeCode_5 length = 8
            format = 14.
            informat = 14.
            label = 'TradeCode_5',
         TradeInc   
            format = 19.2
            informat = 19.2
            label = 'TradeInc',
         TS_LAST_UPDATE_FINANCIAL   
            format = DATETIME22.3
            informat = DATETIME22.3
            label = 'TS_LAST_UPDATE_FINANCIAL',
         TS40RlfAmt   
            format = 19.2
            informat = 19.2
            label = 'TS40RlfAmt',
         TS40RlfInd   
            label = 'TS40RlfInd',
         TTotInd   
            label = 'TTotInd',
         Turnover_1   
            format = 19.2
            informat = 19.2
            label = 'Turnover_1',
         Turnover_2   
            format = 19.2
            informat = 19.2
            label = 'Turnover_2',
         Turnover_3   
            format = 19.2
            informat = 19.2
            label = 'Turnover_3',
         Turnover_4   
            format = 19.2
            informat = 19.2
            label = 'Turnover_4',
         Turnover_5   
            format = 19.2
            informat = 19.2
            label = 'Turnover_5',
         TxAssess   
            format = 19.2
            informat = 19.2
            label = 'TxAssess',
         TxBalance   
            format = 19.2
            informat = 19.2
            label = 'TxBalance',
         TxCrS40SRSTDSOvr   
            label = 'TxCrS40SRSTDSOvr',
         TxDeductSTCDisrgr   
            format = 19.2
            informat = 19.2
            label = 'TxDeductSTCDisrgr',
         TxDefAmt   
            format = 19.2
            informat = 19.2
            label = 'TxDefAmt',
         TxEmprContrOvsPFund   
            format = 19.2
            informat = 19.2
            label = 'TxEmprContrOvsPFund',
         TxFstNAmt   
            format = 19.2
            informat = 19.2
            label = 'TxFstNAmt',
         TxXSOG_1   
            format = 19.2
            informat = 19.2
            label = 'TxXSOG_1',
         TxXSOG_2   
            format = 19.2
            informat = 19.2
            label = 'TxXSOG_2',
         TxXSOG_3   
            format = 19.2
            informat = 19.2
            label = 'TxXSOG_3',
         UnutilCACF_1   
            format = 19.2
            informat = 19.2
            label = 'UnutilCACF_1',
         UnutilCACF_2   
            format = 19.2
            informat = 19.2
            label = 'UnutilCACF_2',
         UnutilCACF_3   
            format = 19.2
            informat = 19.2
            label = 'UnutilCACF_3',
         UnutilCACF_4   
            format = 19.2
            informat = 19.2
            label = 'UnutilCACF_4',
         UnutilCACF_5   
            format = 19.2
            informat = 19.2
            label = 'UnutilCACF_5',
         WifeRlfAmt   
            format = 19.2
            informat = 19.2
            label = 'WifeRlfAmt',
         WifeRlfTyp   
            label = 'WifeRlfTyp',
         YR_YA_FORM   
            label = 'YR_YA_FORM',
         ZakatO   
            format = 19.2
            informat = 19.2
            label = 'ZakatO',
         ZakatT   
            format = 19.2
            informat = 19.2
            label = 'ZakatT',
         VCMASep   
            format = 19.2
            informat = 19.2
            label = 'VCMASep'
   from UDPADMS.DWER_HIST_TDW_IIT_FORM_F_INT
   ;
quit;

/** Delete the int dataset **/
proc datasets lib = UDPADMS nolist nowarn memtype = (data view);
   delete DWER_HIST_TDW_IIT_FORM_F_INT; 
quit;


%let SYSLAST = UDPADMS.DWER_HIST_TDW_IIT_FORM_F;

%global etls_sql_pushDown;
%let etls_sql_pushDown = &sys_sql_ip_all;

%rcSet(&sqlrc); 


/** Step end Extract **/

%let etls_endTime = %sysfunc(datetime(),datetime.);

/**************************************************************************** 
 * Job:             POPULATE_STAGING_ST_TDW_IIT_FORM_F    A5TM814S.BN000MLE * 
 * Description:     Version 1.0                                             * 
 *                                                                          * 
 * Metadata Server: NESAS01R.IRASOR.GOV.SG                                  * 
 * Port:            8565                                                    * 
 * Location:        /ADMS_UDP/PopulateStaging                               * 
 *                                                                          * 
 * Server:          SASDI                                 A5TM814S.AT000002 * 
 *                                                                          * 
 * Source Tables:   DWER_HIST_TDW_IIT_FORM_F  -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                             * 
 *                  DWER_HIST_TDW_IIT_FORM_F  -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                             * 
 * Target Tables:   ST_TDW_IIT_FORM_F -                   A5TM814S.BH000LAM * 
 *                   ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450                              * 
 *                  ST_TDW_IIT_FORM_F -                   A5TM814S.BH000LAM * 
 *                   ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450                              * 
 *                                                                          * 
 * Generated on:    Wednesday, 12 August, 2020 5:59:16 PM SGT               * 
 * Generated by:    INL9BYP@IRAS                                            * 
 * Version:         SAS Data Integration Studio 4.904                       * 
 ****************************************************************************/ 

/* Generate the process id for job  */ 
%put Process ID: &SYSJOBID;

/* General macro variables  */ 
%let jobID = %quote(A5TM814S.BN000MLE);
%let etls_jobName = %nrquote(POPULATE_STAGING_ST_TDW_IIT_FORM_F);
%let etls_userID = %nrquote(INL9BYP@IRAS);

/* Setup to capture return codes  */ 
%global job_rc trans_rc sqlrc;
%let sysrc = 0;
%let job_rc = 0;
%let trans_rc = 0;
%let sqlrc = 0;
%let syscc = 0;
%global etls_stepStartTime; 
/* initialize syserr to 0 */ 
data _null_; run;

%macro rcSet(error); 
   %if (&error gt &trans_rc) %then 
      %let trans_rc = &error;
   %if (&error gt &job_rc) %then 
      %let job_rc = &error;
%mend rcSet; 

%macro rcSetDS(error); 
   if &error gt input(symget('trans_rc'),12.) then 
      call symput('trans_rc',trim(left(put(&error,12.))));
   if &error gt input(symget('job_rc'),12.) then 
      call symput('job_rc',trim(left(put(&error,12.))));
%mend rcSetDS; 

/* Create metadata macro variables */
%let IOMServer      = %nrquote(SASDI);
%let metaPort       = %nrquote(8565);
%let metaServer     = %nrquote(NESAS01R.IRASOR.GOV.SG);

/* Setup for capturing job status  */ 
%let etls_startTime = %sysfunc(datetime(),datetime.);
%let etls_recordsBefore = 0;
%let etls_recordsAfter = 0;
%let etls_lib = 0;
%let etls_table = 0;

%global etls_debug; 
%macro etls_setDebug; 
   %if %str(&etls_debug) ne 0 %then 
      OPTIONS MPRINT%str(;); 
%mend; 
%etls_setDebug; 

/*==========================================================================* 
 * Step:            UDP_Character_Fields_Treatment        A5TM814S.BP0014V0 * 
 * Transform:       UDP_Character_Fields_Treatment                          * 
 * Description:     S1 - changed                                            * 
 *                                                                          * 
 * Source Table:    DWER_HIST_TDW_IIT_FORM_F  -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                             * 
 * Target Table:    ST_TDW_IIT_FORM_F -                   A5TM814S.BH000LAM * 
 *                   ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450                              * 
 *==========================================================================*/ 

%let transformID = %quote(A5TM814S.BP0014V0);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(UDPADMS.DWER_HIST_TDW_IIT_FORM_F); 

%let _INPUT_count = 1; 
%let _INPUT = UDPADMS.DWER_HIST_TDW_IIT_FORM_F;
%let _INPUT_ = UDPADMS.DWER_TDW_IIT_FORM_F;
%let _INPUT_connect = null;
%let _INPUT_engine = BASE;
%let _INPUT_memtype = DATA;
%let _INPUT_options = %nrquote();
%let _INPUT_alter = %nrquote();
%let _INPUT_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/DWER_HIST_TDW_IIT_FORM_F%(Table%));
%let _INPUT_type = 1;
%let _INPUT_label = %nrquote();

%let _INPUT0 = UDPADMS.DWER_HIST_TDW_IIT_FORM_F;
%let _INPUT0_connect = null;
%let _INPUT0_engine = BASE;
%let _INPUT0_memtype = DATA;
%let _INPUT0_options = %nrquote();
%let _INPUT0_alter = %nrquote();
%let _INPUT0_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/DWER_HIST_TDW_IIT_FORM_F%(Table%));
%let _INPUT0_type = 1;
%let _INPUT0_label = %nrquote();

%let _OUTPUT_count = 1; 
%let _OUTPUT = ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450;
%let _OUTPUT_connect =  SERVER="10.7.78.52" AUTHDOMAIN="Hp_auth"  SCHEMA=ads_stg  PORT=10000
;
%let _OUTPUT_engine = HADOOP;
%let _OUTPUT_memtype = DATA;
%let _OUTPUT_options = %nrquote();
%let _OUTPUT_alter = %nrquote();
%let _OUTPUT_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/PopulateStaging/ST_TDW_IIT_FORM_F_ISSUE_450%(Table%));
%let _OUTPUT_type = 1;
%let _OUTPUT_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT_keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;

%let _OUTPUT0 = ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450;
%let _OUTPUT0_connect =  SERVER="10.7.78.52" AUTHDOMAIN="Hp_auth"  SCHEMA=ads_stg  PORT=10000
;
%let _OUTPUT0_engine = HADOOP;
%let _OUTPUT0_memtype = DATA;
%let _OUTPUT0_options = %nrquote();
%let _OUTPUT0_alter = %nrquote();
%let _OUTPUT0_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/PopulateStaging/ST_TDW_IIT_FORM_F%(Table%));
%let _OUTPUT0_type = 1;
%let _OUTPUT0_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT0_keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;



/* List of target columns to keep  */ 
%let _keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;
/* List of target columns to keep  */ 
%let keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;
options minoperator;

data column_fixes;
infile datalines delimiter = ',' truncover;
input st_tbl_nm : $32. col_nm : $ 32. keep_kb : $ 1. del_ctl_chars : $ 1. dbl_to_single : $ 1.;
datalines;
isds_tbl_assessmentdetails,st_trnfr_share_in ,Y,N,N
isds_tbl_assessmentdetails,ta_estat_of_decsd  ,Y,N,N
isds_tbl_assessmentmaster,case_refer_numbr ,Y,N,N
isds_tbl_assessmentmaster,entty_name ,Y,N,N
isds_tbl_assessmentmaster,entty_phone_numbr ,Y,N,N
isds_tbl_assessmentmaster,other_remsn ,Y,N,N
isds_tbl_assessmentmaster,reson_for_penlt ,Y,N,N
isds_tbl_assessmentmaster,user_refer_numbr ,Y,N,N
isds_tbl_assessmentparty,assmt_party_id  ,Y,N,N
isds_tbl_assessmentparty,assmt_party_name ,Y,N,N
sieb_s_evt_act,COMMENTS_LONG ,Y,N,N
sieb_s_evt_act,NAME ,Y,N,N
sieb_s_evt_act,X_NAT_OF_ENQ_CD ,Y,N,N
sieb_s_evt_act,X_ACTION_CD ,Y,N,N
sieb_s_evt_act,X_SOURCE ,Y,N,N
isds_tbl_address,addrs_line1 ,Y,N,N
isds_tbl_address,addrs_line2 ,Y,N,N
isds_tbl_address,stret_name ,Y,N,N
isds_tbl_address,postl_code ,Y,N,N
isds_tbl_address,block_numbr ,Y,N,N
isds_tbl_address,unit_numbr ,Y,N,N
sieb_s_org_ext,LOC ,Y,N,N
sieb_s_org_ext,NAME ,Y,N,N
sieb_s_org_ext,X_TX_QUALFN ,Y,N,N
sieb_s_opty,X_CODE_03 ,Y,N,N
sieb_s_opty,X_RESULT_REMARK ,Y,N,N
sieb_s_opty,X_SELECT_DESC ,Y,N,N
sieb_s_opty,X_SOURCE ,Y,N,N
sieb_s_evt_mail,EMAIL_BODY ,Y,N,N
sieb_s_contact,LAST_NAME ,Y,N,N
sieb_cx_entity_id,name ,Y,N,N
sieb_cx_entity_id,x_text1_extra ,Y,N,N
icorp_offcrinpcase,ProjectName,Y,N,N
icorp_offcrinpissue,Issue,Y,N,N
dwer_tdw_ppty_trf_dtl,TX_SOLICITOR_REF ,Y,N,N
dwer_tdw_audit_case,ID_SELECTION ,Y,N,N
dwer_tdw_audit_case,TX_PRIMARY_TRADE_CODE ,Y,N,N
dwer_tdw_audit_case,TX_SECONDARY_TRADE_CODE ,Y,N,N
dwer_tdw_audit_case,ID_CASE ,Y,N,N
dwer_tdw_audit_case,TX_REASON_CLOSE ,Y,N,N
dwer_tdw_audit_case,NM_TEAM ,Y,N,N
dwer_tdw_audit_case,TX_RESULT_OUTCOME ,Y,N,N
dwer_tdw_audit_case,TX_BRANCH ,Y,N,N
dwer_tdw_audit_case,ID_OFFICER_ASSIGN ,Y,N,N
dwer_tdw_audit_case,TX_AUDIT_CASE_STATUS ,Y,N,N
dwer_tdw_audit_case,TX_AUDIT_PROGRAM ,Y,N,N
dwer_tdw_audit_case,TX_TAX ,Y,N,N
dwer_tdw_audit_case,TX_AUDIT ,Y,N,N
DWER_TDW_CASE_CP,ID_OFFICER ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,ID_EMPLOYER     ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,TX_WP_PROCESSED ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,TX_WP_SCHEME    ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,TX_WP_STATUS    ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,TX_MARITAL_STATUS ,N,Y,N
DWER_TDW_AI_WORK_PERMIT,IN_COMPLETED      ,N,Y,N
DWER_TDW_AI_SAL_MPALW_NSP,NM_ASSET ,N,Y,Y
DWER_TDW_TENANCY_DTL,IN_OCCUP_STATUS     ,N,Y,N
DWER_TDW_TENANCY_DTL,IN_DT_START_OCCUP   ,N,Y,N
DWER_TDW_TENANCY_DTL,IN_DT_CEASED_OCCUP  ,N,Y,N
DWER_TDW_TENANCY_DTL,IN_VAR_RENTAL       ,N,Y,N
DWER_TDW_TENANCY_DTL,NM_ENTITY           ,N,Y,Y
DWER_TDW_TENANCY_DTL,TX_USER_AREA_LET    ,N,Y,N
DWER_TDW_RELATIONSHIP,IN_MAILIN_TO_AGENT  ,N,Y,N
DWER_TDW_RELATIONSHIP,IN_JOINT_FILER      ,N,Y,N
DWER_TDW_RELATIONSHIP,IN_DEFAULT          ,N,Y,N
DWER_TDW_PT_REFUND,ID_APPROVED_BY    ,N,Y,N
DWER_TDW_PT_REFUND,ID_CERTIFIED_BY   ,N,Y,N
DWER_TDW_PT_REFUND,ID_REVIEWED_BY    ,N,Y,N
DWER_TDW_PT_REFUND,ID_UPDATED_BY     ,N,Y,N
DWER_TDW_BUILDING_DTL,NM_LESSOR ,Y,N,N
DWER_TDW_BUILDING_DTL,ID_ESTATE ,N,Y,N
DWER_TDW_BUILDING_DTL,CD_SPECIAL_FEATURE ,N,Y,N
DWER_TDW_BUILDING_DTL,IN_ASSESS_ON_BLDG ,N,Y,N
Dwer_tdw_address_usage,TX_ADDR_ATTN_NAME ,N,Y,Y
Dwer_tdw_address_usage,ID_ADDRESS ,N,Y,N
Dwer_tdw_address_perm,TX_ADDR_LINE1 ,N,N,Y
Dwer_tdw_address_perm,TX_ADDR_LINE2,N,N,Y
Dwer_tdw_address_perm,TX_ADDR_LINE3,N,N,Y
Dwer_tdw_nr_detail,NM_ENTITY_PAYEE ,N,Y,Y
Dwer_tdw_nr_detail,NATUREPAYMENTOTHERS ,N,N,Y
Dwer_tdw_nr_detail,ID_PAYEE ,N,Y,N
irin_t_ai_pship_trust,NM_ASSET ,N,Y,Y
dwer_tdw_entity_id,ID_ENTITY ,Y,N,Y
XBRL_T_XBRL_ADMS_LABEL,TX_COMPANY_LABEL ,Y,N,N
XBRL_T_XBRL_ADMS_ELEMENT,TX_XBRL_ELEMENT_VALUE ,Y,N,N
XBRL_T_XBRL_ADMS_CONTEXT_REF,TX_CONTEXT_REF ,Y,N,N
XBRL_T_XBRL_ADMS_CONTEXT_REF,TX_CONTEXT_REF_VALUE ,Y,N,N
IRIN_T_BANKRUPTCY,ID_HISTORY_REF ,Y,N,N
IRIN_T_BUSINESS_DTL,ID_HISTORY_REF ,Y,N,N
IRIN_T_CED_GST,ID_HISTORY_REF ,Y,N,N
IRIN_T_ES_GST_DELIN,ID_HISTORY_REF ,Y,N,N
IRIN_T_CASE_ITEM,ID_HISTORY_REF ,Y,N,N
IRIN_T_CASE_ITEM,NM_ENTITY_PAYEE ,Y,N,N
IRIN_T_CASE_ITEM,ID_ENTITY_PAYEE ,Y,N,N
IRIN_T_SUPPRESSION,ID_HISTORY_REF ,Y,N,N
IRIN_T_SUPPRESSION,TX_REMARKS ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,TX_REMARKS ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,IN_DOC_TYPE ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,ID_INVOICE_DETAIL ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,ID_DOC_SOURCE ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,ID_MODE ,Y,N,N
DWER_TDW_XREF_INVOICE_DETAIL,ID_REF_NO ,Y,N,N
DWER_TDW_INSTALMENT_PLAN, ID_UPDATED_BY, Y,N,N
DWER_TDW_INSTALMENT_PLAN, IN_VARIABLE_PYMT, Y,N,N
DWER_TDW_SPECIAL_ATTENTION, ID_ROW, Y,N,N
DWER_TDW_SPECIAL_ATTENTION, TX_ATTENTION, Y,N,N
DWER_TDW_SPECIAL_ATTENTION, TX_ATTENTION_DESC, Y,N,N
DWER_TDW_SPECIAL_ATTENTION, TX_STATUS, Y,N,N
T_ADM_QT_ENTITY_TYPE, trade_desc_5digit, Y,N,N
;
run;

%macro Character_Fields_Treatment / mindelimiter = ' ';
/*	proc sql noprint;*/
/*		select distinct upcase(st_tbl_nm) into :tbl_fix_lst separated by ' '*/
/*			from column_fixes;*/
/*	quit;*/
/**/
	%let _SRC = %scan(&_INPUT,2,'.');
	%local rem_list keep_kb_list;

	%if 1 
	  %then %do;
			proc contents data = &_INPUT out = src_tbl_dtls(keep = name type where =(type = 2)) noprint;		
			run;	
			proc sql noprint;
				select col_nm, count(*) into :keep_kb_list separated by ' ', :keep_kb_list_cnt
					from column_fixes
					where upcase(st_tbl_nm) = "&_SRC" and keep_kb = 'Y'
				;
/*				select col_nm, count(*) into :del_ctl_chars_list separated by ' ', :del_ctl_chars_list_cnt*/
/*					from column_fixes*/
/*					where upcase(st_tbl_nm) = "&_SRC" and del_ctl_chars = 'Y'*/
/*				;*/
/*				select col_nm, count(*) into :dbl_to_single_list separated by ' ', :dbl_to_single_list_cnt*/
/*					from column_fixes*/
/*					where upcase(st_tbl_nm) = "&_SRC" and dbl_to_single = 'Y'*/
/*				;*/
				select name, count(*) into :rem_list separated by ' ', :rem_list_cnt
					from src_tbl_dtls
				;
			quit;

/*			%put keep_kb_list_cnt=&keep_kb_list_cnt del_ctl_chars_list_cnt=&del_ctl_chars_list_cnt dbl_to_single_list_cnt=&dbl_to_single_list_cnt;*/

			%if &keep_kb_list_cnt ne 0 OR &rem_list_cnt ne 0 %then %do;
			data &_INPUT;
				set &_INPUT;
					%do i = 1 %to &keep_kb_list_cnt;
						%scan(&keep_kb_list,&i,' ') = compress(%scan(&keep_kb_list,&i,' '),' `~!@#$%^&*()_-+={}[]:;",.<>/?\' || "'",'KNS');
					%end;
					%do i = 1 %to &rem_list_cnt;
						%scan(&rem_list,&i,' ') = compress(%scan(&rem_list,&i,' '),,'C');
					%end;
					%do i = 1 %to &rem_list_cnt;
						%scan(&rem_list,&i,' ') = tranwrd(%scan(&rem_list,&i,' '),'"',"'");
					%end;
			run;
			%end;
	  %end;
%mend;

%Character_Fields_Treatment

%rcSet(&syserr); 
%rcSet(&sysrc); 
%rcSet(&sqlrc); 



/** Step end UDP_Character_Fields_Treatment **/

/*==========================================================================* 
 * Step:            UDP_Incremental_Load                  A5TM814S.BP0014V1 * 
 * Transform:       UDP_Incremental_Load                                    * 
 * Description:     S2 - changed                                            * 
 *                                                                          * 
 * Source Table:    DWER_HIST_TDW_IIT_FORM_F  -                 A5TM814S.BH000LIW * 
 *                   UDPADMS.DWER_HIST_TDW_IIT_FORM_F                             * 
 * Target Table:    ST_TDW_IIT_FORM_F -                   A5TM814S.BH000LAM * 
 *                   ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450                              * 
 *==========================================================================*/ 

%let transformID = %quote(A5TM814S.BP0014V1);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(UDPADMS.DWER_HIST_TDW_IIT_FORM_F); 

%let _INPUT_count = 1; 
%let _INPUT = UDPADMS.DWER_HIST_TDW_IIT_FORM_F;
%let _INPUT_ = UDPADMS.DWER_TDW_IIT_FORM_F;
%let _INPUT_connect = null;
%let _INPUT_engine = BASE;
%let _INPUT_memtype = DATA;
%let _INPUT_options = %nrquote();
%let _INPUT_alter = %nrquote();
%let _INPUT_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/DWER_HIST_TDW_IIT_FORM_F%(Table%));
%let _INPUT_type = 1;
%let _INPUT_label = %nrquote();

%let _INPUT0 = UDPADMS.DWER_HIST_TDW_IIT_FORM_F;
%let _INPUT0_connect = null;
%let _INPUT0_engine = BASE;
%let _INPUT0_memtype = DATA;
%let _INPUT0_options = %nrquote();
%let _INPUT0_alter = %nrquote();
%let _INPUT0_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/DWER_HIST_TDW_IIT_FORM_F %(Table%));
%let _INPUT0_type = 1;
%let _INPUT0_label = %nrquote();

%let _OUTPUT_count = 1; 
%let _OUTPUT = ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450;
%let _OUTPUT_connect =  SERVER="10.7.78.52" AUTHDOMAIN="Hp_auth"  SCHEMA=ads_stg  PORT=10000
;
%let _OUTPUT_engine = HADOOP;
%let _OUTPUT_memtype = DATA;
%let _OUTPUT_options = %nrquote();
%let _OUTPUT_alter = %nrquote();
%let _OUTPUT_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/PopulateStaging/ST_TDW_IIT_FORM_F_ISSUE_450%(Table%));
%let _OUTPUT_type = 1;
%let _OUTPUT_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT_keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;

%let _OUTPUT0 = ads_stg.ST_TDW_IIT_FORM_F_ISSUE_450;
%let _OUTPUT0_connect =  SERVER="10.7.78.52" AUTHDOMAIN="Hp_auth"  SCHEMA=ads_stg  PORT=10000
;
%let _OUTPUT0_engine = HADOOP;
%let _OUTPUT0_memtype = DATA;
%let _OUTPUT0_options = %nrquote();
%let _OUTPUT0_alter = %nrquote();
%let _OUTPUT0_path = %nrquote(/ADMS_UDP/ADMS_UDP_DATA/PopulateStaging/ST_TDW_IIT_FORM_F%(Table%));
%let _OUTPUT0_type = 1;
%let _OUTPUT0_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT0_keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;



/* List of target columns to keep  */ 
%let _keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;
/* List of target columns to keep  */ 
%let keep = adjpl_1 adjpl_2 adjpl_3 adjpl_4 adjpl_5 adjplind_1 adjplind_2 
        adjplind_3 adjplind_4 adjplind_5 adjtemptil adjtotemptincome 
        allowdeduct_1 allowdeduct_2 allowdeduct_3 allowdeduct_4 allowdeduct_5 
        am_nta_diff am_nta_original amtgndef assessincome bktotind bonus_1 
        bonus_2 bonus_3 bpasstotremecr bpasstxcomp cabf cabf_1 cabf_2 cabfovr 
        cd_asmt_mode cd_asmt_status cd_form cd_tax cd_transaction 
        cd_update_reason cd_update_source ci clearance coursefeerlf cpfcashrlf 
        cpfdc cpftimeapportmtsgemptincome cramount_1 cramount_2 cramount_3 
        cramount_4 cramount_5 cramount_6 cramount_7 cramount_8 cramount_9 
        cramount_10 crothersamt crecramt_1 crecramt_2 crecramt_3 crecramt_4 
        crecramt_5 crecramt_6 crecramt_7 crecramt_8 crecramt_9 crecramt_10 
        cridno_1 cridno_2 cridno_3 cridno_4 cridno_5 cridno_6 cridno_7 
        cridno_8 cridno_9 cridno_10 cridtyp_1 cridtyp_2 cridtyp_3 cridtyp_4 
        cridtyp_5 cridtyp_6 cridtyp_7 cridtyp_8 cridtyp_9 cridtyp_10 crorder_1 
        crorder_2 crorder_3 crorder_4 crorder_5 crorder_6 crorder_7 crorder_8 
        crorder_9 crorder_10 crtyp_1 crtyp_2 crtyp_3 crtyp_4 crtyp_5 crtyp_6 
        crtyp_7 crtyp_8 crtyp_9 crtyp_10 crwmcramt_1 crwmcramt_2 crwmcramt_3 
        crwmcramt_4 crwmcramt_5 crwmcramt_6 crwmcramt_7 crwmcramt_8 
        crwmcramt_9 crwmcramt_10 crotherswmcramt crwmcrind_1 crwmcrind_2 
        crwmcrind_3 crwmcrind_4 crwmcrind_5 crwmcrind_6 crwmcrind_7 
        crwmcrind_8 crwmcrind_9 crwmcrind_10 delhospexp delhospexpdc 
        determinelevel dirfees_1 dirfees_2 dirfees_3 disablesuspind donatbf 
        donatcfind donatclaim donation_1 donation_2 donatpns donatutil 
        dt_created dt_effective dt_last_extract dt_process dt_tax_pd_begin 
        dt_tax_pd_end earnedincomerlf eci ecinrnonemptrt ecrerrcode 
        ecrerrcodeovr ecrind eebrind efilingerr emplcpfaii 
        emplincomenetincome_1 emplincomenetincome_2 emplincomenetincome_3 
        emplincometxref_1 emplincometxref_2 emplincometxref_3 emptcode_1 
        emptcode_2 emptcode_3 emptincomeadjind emptincomeovr emptystatus exp_1 
        exp_2 exp_3 fiovr fmforeigntxpaid fmintincomeamt fmlamt fmlrlfdc 
        fmotherincome fmpnsincome fmptyincomeamt fmroyaltyincomeamt fmsubtot 
        fmtradeincomeamt fmtrustincome foreignotherincome_1 
        foreignotherincome_2 frdivincomepns frdivincometrust frfipns frfitrust 
        frintincome frotherfi frptyincome frroyaltyincome frsubtot 
        frtradeincomeamt fsdivincomerate fsgrossdivamt fsintincomeamt 
        fsintincomerate fsotherincomerate fsroyaltyincomeamt 
        fsroyaltyincomerate fssubtot fstnamt fstradeincomerate gcramt gender 
        grosspl_1 grosspl_2 grosspl_3 grosspl_4 grosspl_5 grosstxpy 
        grosstxpybefrebate grosstxpybefstrftr hsramount_1 hsramount_2 
        hsramount_3 hsramount_4 hsramount_5 hsridno_1 hsridno_2 hsridno_3 
        hsridno_4 hsridno_5 hsridtyp_1 hsridtyp_2 hsridtyp_3 hsridtyp_4 
        hsridtyp_5 id_forms_seq id_internal id_rtn_seq id_transaction 
        id_updated_by idoadj in_completed in_gdrtn in_latest_asmt income_1 
        income_2 interest_1 interest_2 intexp_1 intexp_2 laraii lardc 
        lossapportmtadjtotemptincome lossbf lossbf_1 lossbf_2 lossbfind 
        lossbfovramt marginaltaxrate martxrate martxrate1 martxrate2 medisave 
        mpallow mpallowcpfaii mystxrate nettradeil nettxpyrpy nextnamt 
        normanualcalc notionalfstnamt notionalmartxfstnamt 
        notionalmartxfstnamt2 notionaltxfstnamt notionaltxfstnamt2 noyrsdef 
        nrai nrarttxrate nrassessincome nrci nrdonatapportmt 
        nrdonatapportmtotherincome nrdonatapportmtsrswd nremptincome 
        nrempttxrate nrincomesrswd nrnonempttxrate nrotherincome nrs40bcdind 
        nrsrstxrate nrtotnetincome nrtxpy nrtxpyemptsrswd nrtxpyotherincome 
        nrtxpys40 nrtxpys40bcd nsmanincome nsmenrlf ntprofit oneofftxrebate 
        othercradj otherdiv_1 otherdiv_2 otherexp_1 otherexp_2 otherincomedc 
        otherincomeovr otherrrns others_1 others_2 others_3 pension_1 
        phyformtyp pnsnetincome_1 pnsnetincome_2 pnsrent pnstxref_1 pnstxref_2 
        pramount_1 pramount_2 pridno_1 pridno_2 pridtyp_1 pridtyp_2 psleep 
        rcb_1 rcb_2 rcb_3 rcb_4 rcb_5 remind rent_1 rent_2 rescomi 
        residentstatus resind rlfovr s40rlf s46arlf s46brlf salary_1 salary_2 
        salary_3 selfemplcpfaii sgcorptxrate sgdiv_1 sgdiv_2 sgdivtxrate 
        sgotherincome_1 sgotherincome_2 sgtxcredits specialattn 
        specialisedassmt sq_assessment srscontr srstxwithheld statuscode_1 
        statuscode_2 strftramt tartexpertamt tartexpertind 
        tdivintotherincomeamt tdivintotherincomeind tds tdssgdiv_1 tdssgdiv_2 
        tdtrutctxremind tempt456amt tempt456ind thirdcmlpy timeapportmt tloss 
        tnorind totadjpl totallowcf totcpfclaimmatch totcpflarallow totcr 
        totdonatbfclaimmatch totearnedincome toteci totexpintlosscabf_1 
        totexpintlosscabf_2 totfi tothsr totincomeaftrgr totincomebefrgr 
        totincomelessexp totnav totpnsincome totpr totpshpeci totpshpecior 
        totptyincome totrent totrlf totshare_1 totshare_2 tottds tottxcr 
        tottxrem tpns3to10amt tpns3to10ind tprofit tprofitl tpsoaattached 
        tptyind tradecode_1 tradecode_2 tradecode_3 tradecode_4 tradecode_5 
        tradeinc ts_last_update_financial ts40rlfamt ts40rlfind ttotind 
        turnover_1 turnover_2 turnover_3 turnover_4 turnover_5 txassess 
        txbalance txcrs40srstdsovr txdeductstcdisrgr txdefamt 
        txemprcontrovspfund txfstnamt txxsog_1 txxsog_2 txxsog_3 unutilcacf_1 
        unutilcacf_2 unutilcacf_3 unutilcacf_4 unutilcacf_5 wiferlfamt 
        wiferlftyp yr_ya_form zakato zakatt vcmasep nm_src_system 
        dt_adms_updated dt_adms_created;
options minoperator;
options mprint mlogic symbolgen;

%macro MCR_INC_LOAD / mindelimiter = ' ';
	%let CURR_DATETIME = %sysfunc(datetime(),datetime20.);
	%let __OUT__ = %scan(&_OUTPUT,2,.);
    /* Find the position of _ISSUE_450 */
    %let issue_pos = %index(&__OUT__, _ISSUE_450);

    /* Extract the part before _ISSUE_450 if _ISSUE_450 is found */
    %if &issue_pos > 0 %then %do;
        %let __OUT = %substr(&__OUT__, 1, %eval(&issue_pos - 1));
    %end;
    %else %do;
        %let __OUT = &__OUT__;
    %end;
	%let __TMP = %sysfunc(catx(_,TMP,&__OUT));
	%let SRC_SYSTEM = %substr(%scan(&_INPUT,2,'_.'),1,4);
	%local MCR_PK_LIST1 MCR_PK_LIST2 MCR_INC_DATES_LIST1 MCR_INC_DATES_LIST2 SPCL_LD CHNG_OBS ALL_NMS_TMP;
	%let ADMSDATA_TBL = %scan(&_INPUT,2,'.');
    %let ADMSDATA_TBL_ = %scan(&_INPUT_,2,'.');

	proc sql noprint;
		select distinct 
			case 
				when REMARKS ne '' then REMARKS 
				else 'NORMAL' 
			end 
		into :SPCL_LD
			from ADS_STG.T_ADM_CTL_STAGING_DELTA
				where STAGING_TABLE = "&__OUT"
		;
		select PK_VAR, '"' || strip(PK_VAR) || '"' into :MCR_PK_LIST1 separated by ' ', :MCR_PK_LIST2 separated by ',' 
			from ADS_STG.T_ADM_CTL_STAGING_PK
				where STAGING_TABLE = "&__OUT"
		;
	quit;

/*	PK null and duplicate checks */
	%if &__OUT in &PK_TBL_LIST
		%then %do;

		%if &MCR_PK_LIST1 eq %then %do;
			proc sql noprint;
				select name into :MCR_PK_LIST1 separated by ' '
					from dictionary.columns
					where libname = 'UDPADMS' and memname = "&ADMSDATA_TBL_"
				;
			quit;
		%end;
/*
		proc sql nowarn;
			alter table ADMSDATA.&ADMSDATA_TBL
			drop primary key;
		quit;
*/
		proc datasets lib = UDPADMS nodetails nolist;
			modify &ADMSDATA_TBL;
			ic create PRIM_KEY = primary key(&MCR_PK_LIST1);
		run; quit;

	%end;

	/* For Refresh Staging Tables	*/
	%if &__OUT in &REF_TBL_LST %then
		%do;

			proc sql noprint;
				connect to Hadoop
					( 
					&UDP_Connect
					);
				select cnt into :CNT_B4 from connection to Hadoop
					(
				select count(*) as cnt from &UDP_DB_AND_SCHEMA.&__OUT__
					);
				execute 
					( 
					truncate table &UDP_DB_AND_SCHEMA.&__OUT__ 
					) by Hadoop;
				disconnect from Hadoop;
			quit;

			%put NUMBER OF RECORDS TRUNCATED FROM &__OUT__ : &CNT_B4;

			data work.ADMS_NEW_ROWS;
				length nm_src_system $50 dt_adms_updated dt_adms_created 8;
				format dt_adms_updated dt_adms_created datetime.;
				set &_INPUT;
				nm_src_system = "&SRC_SYSTEM";
				dt_adms_updated = "&CURR_DATETIME"dt;
				dt_adms_created = "&CURR_DATETIME"dt;
			run;

			%goto insert_rows;
		%end;

	%let INS_TBL_SRC = ADMS_NEW_ROWS;
	%let INS_TBL_LIB = WORK;

	proc sql noprint;
		select DELTA_VAR, DELTA_VAR into :MCR_INC_DATES_LIST1 separated by ' ', :MCR_INC_DATES_LIST2 separated by ','
			from ADS_STG.T_ADM_CTL_STAGING_DELTA
				where STAGING_TABLE = "&__OUT"
		;
		connect to Hadoop
			( 
			&UDP_Connect
			);
		select cnt into :CNT_B4 from connection to Hadoop
			(
		select count(*) as cnt from &UDP_DB_AND_SCHEMA.&__TMP
			);
		execute 
			( 
			truncate table &UDP_DB_AND_SCHEMA.&__TMP 
			) by Hadoop;
		disconnect from Hadoop;
	quit;

	%put NUMBER OF RECORDS TRUNCATED FROM &__TMP : &CNT_B4;

	data work.etls_compare_digest(keep = &MCR_PK_LIST1);
		set &_OUTPUT(keep = &MCR_PK_LIST1);
	run;

	/* source/compare lookup: hash lookup method  */
	data work.ADMS_CHANGED_ROWS
		work.ADMS_NEW_ROWS
		work.W7UBXY2H;
		length source_digest $ 32 nm_src_system $ 50 dt_adms_updated dt_adms_created 8;
		format dt_adms_updated dt_adms_created datetime.;
		drop rc;

		if 0 then
			set work.etls_compare_digest;

		if _N_ eq 1 then
			do;
				declare hash hct(dataset: 'work.etls_compare_digest', hashexp: 10);
				hct.defineKey(&MCR_PK_LIST2);
				hct.defineData(&MCR_PK_LIST2);
				hct.defineDone();
			end;

		set &_INPUT end = eof;
		nm_src_system = "&SRC_SYSTEM";
		dt_adms_updated = "&CURR_DATETIME"dt;
		dt_adms_created = "&CURR_DATETIME"dt;

		/* source/compare match  */
		if hct.find() eq 0 then
			do;
				output work.ADMS_CHANGED_ROWS;

				/* remove found key + data  */
				hct.remove();
			end;

		/* source table: new records  */
		else if hct.find() ne 0 then
			output work.ADMS_NEW_ROWS;

		if eof then
			rc = hct.output(dataset: 'work.etls_missing_records');
	run;

	/*	proc sql;*/
	/*		create table INC_LD.&__OUT._NW as select * from work.ADMS_NEW_ROWS;*/
	/*		create table INC_LD.&__OUT._UP as select * from work.ADMS_CHANGED_ROWS;*/
	/*	quit;*/
	proc sql noprint;
		select nlobs into :CHNG_OBS from dictionary.tables 
			where libname = 'WORK' and memname = 'ADMS_CHANGED_ROWS';
	quit;

	%if &CHNG_OBS ne 0 and %sysfunc(exist(work.ADMS_CHANGED_ROWS)) eq 1 %then
		%do;
			%put Change records detected for &_OUTPUT;

			/*Bulkload insert update rows which contains the PK of the target table*/
			proc contents data =  &UDP_DB_AND_SCHEMA.&__TMP out = output_tmp_tbl_dtls noprint;
			run;

			proc sort data = output_tmp_tbl_dtls;
				by varnum;
			run;

			proc sql noprint;
				select name into :ALL_NMS_TMP separated by ','
					from output_tmp_tbl_dtls
						order by varnum;
			quit;

			proc sql;
				insert into &UDP_DB_AND_SCHEMA.&__TMP 
					select &ALL_NMS_TMP from work.ADMS_CHANGED_ROWS
				;
			quit;

			/*Delete updated records in the target HADOOP*/
			proc sql;
				connect to Hadoop
					( 
					&UDP_Connect
					);
				execute 
					( 
				delete from &__OUT__
					where exists
						(
					select * from &__TMP where
						%let iCnt = 1;
						%let PKCOL_TMP = %scan(&MCR_PK_LIST1,&iCnt,' ');

						%do
							%while(&PKCOL_TMP ne);
							%if (%upcase(&__OUT)=ST_TDW_EXEMPTION_PV AND %upcase(&PKCOL_TMP)=ID_EXEMPT_CERT ) OR
							(%upcase(&__OUT)=ST_TDW_AI_SOG AND %upcase(&PKCOL_TMP)=IN_DEEMED ) OR
							(%upcase(&__OUT)=ST_T_ASSESSMENT AND %upcase(&PKCOL_TMP)=DT_TAX_PD_BEGIN ) 
							%then

					%do;
						(&__OUT__..&PKCOL_TMP = &__TMP..&PKCOL_TMP OR (&__OUT__..&PKCOL_TMP is null and &__TMP..&PKCOL_TMP is null))
					%end;
	%else
		%do;
			&__OUT__..&PKCOL_TMP = &__TMP..&PKCOL_TMP
		%end;

	%let iCnt = %eval(&iCnt + 1);
	%let PKCOL_TMP = %scan(&MCR_PK_LIST1,&iCnt,' ');

	%if &PKCOL_TMP ne %then
		AND;
		%end;
	) ) by HADOOP;
	disconnect from HADOOP;
			quit;

			proc append base = work.ADMS_NEW_ROWS data = work.ADMS_CHANGED_ROWS;
			run;

%end;

	%insert_rows:

			proc sql noprint;
				select nlobs into :NEW_OBS from dictionary.tables 
					where libname = "WORK" and memname = "ADMS_NEW_ROWS";
			quit;

			%if &NEW_OBS ne 0 and %sysfunc(exist(work.ADMS_NEW_ROWS)) eq 1 %then
				%do;

					proc contents data = &_OUTPUT out = output_tbl_dtls noprint;
					run;

					proc sort data = output_tbl_dtls;
						by varnum;
					run;

					proc sql noprint;
						select name into :ALL_NMS separated by ','
							from output_tbl_dtls
						;
					quit;

					%IF &__OUT=ST_T_ENQUIRY_MESSAGE %THEN
						%DO;

							proc sql;
								insert into &_OUTPUT  select &ALL_NMS from work.ADMS_NEW_ROWS
								;
							quit;

							proc sql noprint;
								connect to Hadoop
									( 
									&UDP_Connect
									);
								select cnt into :CNT_AFTER from connection to Hadoop
									(
								select count(*) as cnt from &UDP_DB_AND_SCHEMA.&__OUT
									);
							Quit;

							%put NUMBER OF RECORDS LOADED TO &__OUT : &CNT_AFTER;

							proc sql noprint;
								connect to Hadoop
									( 
									&UDP_Connect
									);
								execute 
									(
								UPDATE &_OUTPUT
									SET TX_MESSAGE_CONTENT = REGEXP_REPLACE(TX_MESSAGE_CONTENT, '<B>', '\n')
								) by Hadoop;
							quit;

						%END;
					%ELSE
						%DO;

							proc sql;
								insert into &_OUTPUT select &ALL_NMS from work.ADMS_NEW_ROWS
								;
							quit;

							proc sql noprint;
								select count(*) format = 20. into :TGT_CNT from &_OUTPUT
									where dt_adms_created = "&CURR_DATETIME"dt
								;
								select count(*) format = 20. into :SRC_CNT from work.ADMS_NEW_ROWS;
							quit;

							%if &TGT_CNT ne &SRC_CNT %then
								%do;
									%put ERROR: Loaded rows in the target table does not match with the expected number of rows to be loaded;

									%abort;
								%end;
						%END;
				%END;
%mend MCR_INC_LOAD;

%MCR_INC_LOAD

%rcSet(&syserr); 
%rcSet(&sysrc); 
%rcSet(&sqlrc); 



/** Step end UDP_Incremental_Load **/

%let etls_endTime = %sysfunc(datetime(),datetime.);
